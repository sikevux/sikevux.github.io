---
layout: post
title: "Nemesis on x86_64"
description: "It doesn't work..."
category: Code
---
{% include JB/setup %}

[Nemesis](http://packetfactory.openwall.net/projects/nemesis/index.html) is a pain to compile on x86_64 since, well, it doesn't work.

First of it uses [libnet-1.0.2a](http://packetfactory.openwall.net/libnet/dist/deprecated/libnet-1.0.2a.tar.gz), and that's basically deprecated, and it's strange to compile.

To compile libnet then:
Download source.
./configure

Then we need to patch libnet to work with us:
{% highlight diff %}
--- Makefile	2012-09-11 18:40:01.477705853 +0200
+++ Makefile.new	2012-09-11 18:39:22.270705804 +0200
@@ -17,7 +17,7 @@
 BIN_PREFIX  =   ${exec_prefix}/bin/
 INC_PREFIX  =   ${prefix}/include/
 LIB_PREFIX  =   ${exec_prefix}/lib/
-MAN_PREFIX  =   
+MAN_PREFIX  = /usr/share/doc/   
 
 LIBNET      =   libnet
 LIBPWRITE   =   libpwrite
{% endhighlight %}

then make.

Now we need to patch again to make libnet work with nemesis.

{% highlight diff %}

--- libnet-headers.h	2012-09-11 18:32:08.419581256 +0200
+++ libnet-headers.h.new	2012-09-11 18:32:27.742768311 +0200
@@ -388,12 +388,12 @@
 #define ETHERTYPE_VLAN          0x8100  /* IEEE 802.1Q VLAN tagging */
 #define ETHERTYPE_LOOPBACK      0x9000  /* used to test interfaces */
 
-#if (!__GLIBC__)
+//#if (!__GLIBC__)
 struct ether_addr
 {
     u_char  ether_addr_octet[6];
 };
-#endif
+//#endif
 
 /* 
  *  ARP packet header prototype.  Too many O/S's define this differently.
{% endhighlight %}

Note: libnet-headers.h is located in include/libnet/

Now just go on and compile nemesis as you usually would do.